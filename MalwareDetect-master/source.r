library(readr)  # Load the readr package for reading CSV files
library(keras)  # Load the keras package for building neural networks
library(caret)  # Load the caret package for data partitioning

# Load the CSV file into a DataFrame
data <- read_csv('train.csv')

# Split features (X) and target variable (y)
X <- data[, -1]  # Exclude the 'Result' column from the features
y <- data$Result  # Store the 'Result' column as the target variable

# Normalization
X_normalized <- preProcess(X, method = c("center", "scale"))$scaled  # Scale the features using centering and scaling

# Split the data into training and testing sets
set.seed(42)  # Set the seed for reproducibility
indices <- createDataPartition(y, times = 1, p = 0.8, list = FALSE)  # Create indices for data partitioning
X_train <- X_normalized[indices, ]  # Split the normalized features into training set
y_train <- y[indices]  # Split the target variable into training set
X_test <- X_normalized[-indices, ]  # Split the normalized features into testing set
y_test <- y[-indices]  # Split the target variable into testing set

# Define the neural network architecture
model <- keras_model_sequential() %>%  # Define a sequential model
  layer_dense(units = 84, activation = "relu", input_shape = ncol(X_train)) %>%  # Add a dense layer with 84 units and ReLU activation function
  layer_dense(units = 42, activation = "relu") %>%  # Add a dense layer with 42 units and ReLU activation function
  layer_dense(units = 1, activation = "sigmoid")  # Add a dense layer with 1 unit and sigmoid activation function

# Compile the model
model %>% compile(
  loss = "binary_crossentropy",  # Use binary cross-entropy loss function
  optimizer = optimizer_adam(),  # Use Adam optimizer
  metrics = c("accuracy")  # Track accuracy metric during training
)

# Train the model
history <- model %>% fit(
  X_train, y_train,  # Training data
  epochs = 10,  # Number of epochs
  batch_size = 32,  # Batch size
  validation_split = 0.2  # Use 20% of the training data for validation
)

# Evaluate the model
evaluation <- model %>% evaluate(X_test, y_test)  # Evaluate the model on the test data
accuracy <- evaluation$accuracy  # Extract the accuracy from the evaluation results
cat("Test accuracy:", accuracy, "\n")  # Print the test accuracy
